<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Relay Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Relay Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44373548-50"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-44373548-50",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Relay" href="/opensearch.xml">
<script src="/js/redirect.js"></script><title data-react-helmet="true">Mutations | Relay</title><meta data-react-helmet="true" property="og:image" content="https://relay.dev/img/relay.png"><meta data-react-helmet="true" name="twitter:image" content="https://relay.dev/img/relay.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Relay"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="classic"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-classic"><meta data-react-helmet="true" property="og:title" content="Mutations | Relay"><meta data-react-helmet="true" name="description" content="Up until this point we have only interacted with the GraphQL endpoint to perform queries that fetch data. In this guide, you will learn how to use Relay to perform mutations â€“ operations that consist of writes to the data store followed by a fetch of any changed fields."><meta data-react-helmet="true" property="og:description" content="Up until this point we have only interacted with the GraphQL endpoint to perform queries that fetch data. In this guide, you will learn how to use Relay to perform mutations â€“ operations that consist of writes to the data store followed by a fetch of any changed fields."><meta data-react-helmet="true" property="og:url" content="https://relay.dev/docs/classic/classic-guides-mutations"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://relay.dev/docs/classic/classic-guides-mutations"><link rel="stylesheet" href="/styles.a1c7ae73.css">
<link rel="preload" href="/styles.eabf7aae.js" as="script">
<link rel="preload" href="/runtime~main.d6510d2e.js" as="script">
<link rel="preload" href="/main.4ed6baaf.js" as="script">
<link rel="preload" href="/1.c175ab1b.js" as="script">
<link rel="preload" href="/2.3344836f.js" as="script">
<link rel="preload" href="/3.2a8c3dea.js" as="script">
<link rel="preload" href="/1be78505.25680110.js" as="script">
<link rel="preload" href="/1097.563a0540.js" as="script">
<link rel="preload" href="/3acb18f9.c3ef18ff.js" as="script">
<link rel="preload" href="/17896441.c41b5144.js" as="script">
<link rel="preload" href="/08013621.215dc1fa.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">Relay</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/help">Help</a><a href="https://github.com/facebook/relay" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Version</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/">v10.1.3</a></li><li><a class="dropdown__link" href="/docs/v10.1.2/">v10.1.2</a></li><li><a class="dropdown__link" href="/docs/v10.1.1/">v10.1.1</a></li><li><a class="dropdown__link" href="/docs/v10.1.0/">v10.1.0</a></li><li><a class="dropdown__link" href="/docs/v10.0.1/">v10.0.1</a></li><li><a class="dropdown__link" href="/docs/v10.0.0/">v10.0.0</a></li><li><a class="dropdown__link" href="/docs/v9.1.0/">v9.1.0</a></li><li><a class="dropdown__link" href="/docs/v9.0.0/">v9.0.0</a></li><li><a class="dropdown__link" href="/docs/v8.0.0/">v8.0.0</a></li><li><a class="dropdown__link" href="/docs/v7.1.0/">v7.1.0</a></li><li><a class="dropdown__link" href="/docs/v7.0.0/">v7.0.0</a></li><li><a class="dropdown__link" href="/docs/v6.0.0/">v6.0.0</a></li><li><a class="dropdown__link" href="/docs/v5.0.0/">v5.0.0</a></li><li><a class="dropdown__link" href="/docs/v4.0.0/">v4.0.0</a></li><li><a class="dropdown__link" href="/docs/v3.0.0/">v3.0.0</a></li><li><a class="dropdown__link" href="/docs/v2.0.0/">v2.0.0</a></li><li><a class="dropdown__link" href="/docs/v1.7.0/">v1.7.0</a></li><li><a class="dropdown__link" href="/docs/v1.6.2/">v1.6.2</a></li><li><a class="dropdown__link" href="/docs/v1.6.1/">v1.6.1</a></li><li><a class="dropdown__link" href="/docs/v1.6.0/">v1.6.0</a></li><li><a class="dropdown__link" href="/docs/v1.5.0/">v1.5.0</a></li><li><a class="dropdown__link" href="/docs/v1.4.1/">v1.4.1</a></li><li><a class="dropdown__link" href="/docs/experimental/">experimental</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/classic/">classic</a></li><li><a class="dropdown__link" href="/docs/next/">Unreleased</a></li></ul></div><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><div class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></div></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">Relay</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/help">Help</a></li><li class="menu__list-item"><a href="https://github.com/facebook/relay" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item menu__list-item--collapsed"><a aria-current="page" class="menu__link menu__link--sublist navbar__link--active" role="button" href="/docs">Version</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">v10.1.3</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v10.1.2/">v10.1.2</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v10.1.1/">v10.1.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v10.1.0/">v10.1.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v10.0.1/">v10.0.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v10.0.0/">v10.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v9.1.0/">v9.1.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v9.0.0/">v9.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v8.0.0/">v8.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v7.1.0/">v7.1.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v7.0.0/">v7.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v6.0.0/">v6.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v5.0.0/">v5.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v4.0.0/">v4.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v3.0.0/">v3.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v2.0.0/">v2.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v1.7.0/">v1.7.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v1.6.2/">v1.6.2</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v1.6.1/">v1.6.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v1.6.0/">v1.6.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v1.5.0/">v1.5.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/v1.4.1/">v1.4.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/experimental/">experimental</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/classic/">classic</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/">Unreleased</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Relay Classic Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/classic/">Introduction to Relay</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/classic/classic-guides-containers">Containers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/classic/classic-guides-routes">Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/classic/classic-guides-root-container">Root Container</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/classic/classic-guides-ready-state">Ready State</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/classic/classic-guides-mutations">Mutations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/classic/classic-guides-network-layer">Network Layer</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Relay Classic API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay">Relay</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay-container">RelayContainer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay-route">Relay.Route</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay-renderer">Relay.Renderer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay-root-container">Relay.RootContainer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay-ql">Relay.QL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay-mutation">Relay.Mutation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay-graphql-mutation">Relay.GraphQLMutation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay-proptypes">Relay.PropTypes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-api-reference-relay-store">Relay.Store</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Relay Classic Interfaces</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-interfaces-relay-mutation-request">RelayMutationRequest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-interfaces-relay-network-layer">RelayNetworkLayer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/classic/classic-interfaces-relay-query-request">RelayQueryRequest</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for Relay <strong>classic</strong>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/docs/">latest version</a></strong> (11.0.0).</div></div><div class="docItemContainer_a7m4"><article><div><span class="badge badge--secondary">Version: classic</span></div><header><h1 class="docTitle_Oumm">Mutations</h1></header><div class="markdown"><p>Up until this point we have only interacted with the GraphQL endpoint to perform queries that fetch data. In this guide, you will learn how to use Relay to perform mutations â€“ operations that consist of writes to the data store followed by a fetch of any changed fields.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="a-complete-example"></a>A complete example<a class="hash-link" href="#a-complete-example" title="Direct link to heading">#</a></h2><p>Before taking a deep dive into the mutations API, let&#x27;s look at a complete example. Here, we subclass <code>Relay.Mutation</code> to create a custom mutation that we can use to like a story.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class LikeStoryMutation extends Relay.Mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // This method should return a GraphQL operation that represents</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // the mutation to be performed. This presumes that the server</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // implements a mutation type named â€˜likeStoryâ€™.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getMutation() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`mutation {likeStory}`;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Use this method to prepare the variables that will be used as</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // input to the mutation. Our â€˜likeStoryâ€™ mutation takes exactly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // one variable as input â€“ the ID of the story to like.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getVariables() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return {storyID: this.props.story.id};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Use this method to design a â€˜fat queryâ€™ â€“ one that represents every</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // field in your data model that could change as a result of this mutation.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Liking a story could affect the likers count, the sentence that</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // summarizes who has liked a story, and the fact that the viewer likes the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // story or not. Relay will intersect this query with a â€˜tracked queryâ€™</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // that represents the data that your application actually uses, and</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // instruct the server to include only those fields in its response.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getFatQuery() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on LikeStoryPayload {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        story {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          likers {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            count,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          likeSentence,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          viewerDoesLike,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // These configurations advise Relay on how to handle the LikeStoryPayload</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // returned by the server. Here, we tell Relay to use the payload to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // change the fields of a record it already has in the store. The</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // key-value pairs of â€˜fieldIDsâ€™ associate field names in the payload</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // with the ID of the record that we want updated.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getConfigs() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return [{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;FIELDS_CHANGE&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fieldIDs: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        story: this.props.story.id,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // This mutation has a hard dependency on the story&#x27;s ID. We specify this</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // dependency declaratively here as a GraphQL query fragment. Relay will</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // use this fragment to ensure that the story&#x27;s ID is available wherever</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // this mutation is used.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static fragments = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    story: () =&gt; Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on Story {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        id,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Here&#x27;s an example of this mutation in use by a <code>LikeButton</code> component:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class LikeButton extends React.Component {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  _handleLike = () =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // To perform a mutation, pass an instance of one to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // `this.props.relay.commitUpdate`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    this.props.relay.commitUpdate(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      new LikeStoryMutation({story: this.props.story})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  render() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &lt;div&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {this.props.story.viewerDoesLike</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          ? &#x27;You like this&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          : &lt;button onClick={this._handleLike}&gt;Like this&lt;/button&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &lt;/div&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">module.exports = Relay.createContainer(LikeButton, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  fragments: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // You can compose a mutation&#x27;s query fragments like you would those</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // of any other RelayContainer. This ensures that the data depended</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // upon by the mutation will be fetched and ready for use.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    story: () =&gt; Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on Story {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        viewerDoesLike,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ${LikeStoryMutation.getFragment(&#x27;story&#x27;)},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In this particular example, the only field that the <code>LikeButton</code> cares about is <code>viewerDoesLike</code>. That field will form part of the tracked query that Relay will intersect with the fat query of <code>LikeStoryMutation</code> to determine what fields to request as part of the server&#x27;s response payload for the mutation. Another component elsewhere in the application might be interested in the likers count, or the like sentence. Since those fields will automatically be added to Relay&#x27;s tracked query, the <code>LikeButton</code> need not worry about requesting them explicitly.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="mutation-props"></a>Mutation props<a class="hash-link" href="#mutation-props" title="Direct link to heading">#</a></h2><p>Any props that we pass to the constructor of a mutation will become available to its instance methods as <code>this.props</code>. Like in components used within Relay containers, props for which a corresponding fragment has been defined will be populated by Relay with query data:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class LikeStoryMutation extends Relay.Mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static fragments = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    story: () =&gt; Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on Story {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        id,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        viewerDoesLike,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getMutation() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Here, viewerDoesLike is guaranteed to be available.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // We can use it to make this mutation polymorphic.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return this.props.story.viewerDoesLike</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ? Relay.QL`mutation {unlikeStory}`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      : Relay.QL`mutation {likeStory}`;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /* ... */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="fragment-variables"></a>Fragment variables<a class="hash-link" href="#fragment-variables" title="Direct link to heading">#</a></h2><p>Like it can be done with <a href="/docs/classic/classic-guides-containers">Relay containers</a>, we can prepare variables for use by our mutation&#x27;s fragment builders, based on the previous variables and the runtime environment.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class RentMovieMutation extends Relay.Mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static initialVariables = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    format: &#x27;hd&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    lang: &#x27;en-CA&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static prepareVariables = (prevVariables) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var overrideVariables = {};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (navigator.language) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      overrideVariables.lang = navigator.language;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    var formatPreference = localStorage.getItem(&#x27;formatPreference&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (formatPreference) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      overrideVariables.format = formatPreference;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return {...prevVariables, ...overrideVariables};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static fragments = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Now we can use the variables we&#x27;ve prepared to fetch movies</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // appropriate for the viewer&#x27;s locale and preferences</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    movie: () =&gt; Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on Movie {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        posterImage(lang: $lang) { url },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        trailerVideo(format: $format, lang: $lang) { url },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="the-fat-query"></a>The fat query<a class="hash-link" href="#the-fat-query" title="Direct link to heading">#</a></h2><p>Changing one thing in a system can have a ripple effect that causes other things to change in turn. Imagine a mutation that we can use to accept a friend request. This can have wide implications:</p><ul><li>both people&#x27;s friend count will increment</li><li>an edge representing the new friend will be added to the viewer&#x27;s <code>friends</code> connection</li><li>an edge representing the viewer will be added to the new friend&#x27;s <code>friends</code> connection</li><li>the viewer&#x27;s friendship status with the requester will change</li></ul><p>Design a fat query that covers every possible field that could change:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class AcceptFriendRequestMutation extends Relay.Mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getFatQuery() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // This presumes that the server-side implementation of this mutation</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // returns a payload of type `AcceptFriendRequestPayload` that exposes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // `friendEdge`, `friendRequester`, and `viewer` fields.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on AcceptFriendRequestPayload {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        friendEdge,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        friendRequester {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          friends,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          friendshipStatusWithViewer,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        viewer {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          friends,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This fat query looks like any other GraphQL query, with one important distinction. We know some of these fields to be non-scalar (like <code>friendEdge</code> and <code>friends</code>) but notice that we have not named any of their children by way of a subquery. In this way, we indicate to Relay that <em>anything</em> under those non-scalar fields may change as a result of this mutation.</p><blockquote>Note<p>When designing a fat query, consider <em>all</em> of the data that might change as a result of the mutation â€“ not just the data currently in use by your application. We don&#x27;t need to worry about overfetching; this query is never executed without first intersecting it with a â€˜tracked queryâ€™ of the data our application actually needs. If we omit fields in the fat query, we might observe data inconsistencies in the future when we add views with new data dependencies, or add new data dependencies to existing views.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="mutator-configuration"></a>Mutator configuration<a class="hash-link" href="#mutator-configuration" title="Direct link to heading">#</a></h2><p>We need to give Relay instructions on how to use the response payload from each mutation to update the client-side store. We do this by configuring the mutation with one or more of the following mutation types:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="fields_change"></a><code>FIELDS_CHANGE</code><a class="hash-link" href="#fields_change" title="Direct link to heading">#</a></h3><p>Any field in the payload that can be correlated by DataID with one or more records in the client-side store will be merged with the record(s) in the store.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="arguments"></a>Arguments<a class="hash-link" href="#arguments" title="Direct link to heading">#</a></h4><ul><li><p><code>fieldIDs: {[fieldName: string]: DataID | Array&lt;DataID&gt;}</code></p><p>A map between a <code>fieldName</code> in the response and one or more DataIDs in the store.</p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example"></a>Example<a class="hash-link" href="#example" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class RenameDocumentMutation extends Relay.Mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // This mutation declares a dependency on a document&#x27;s ID</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static fragments = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    document: () =&gt; Relay.QL`fragment on Document { id }`,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // We know that only the document&#x27;s name can change as a result</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // of this mutation, and specify it here in the fat query.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getFatQuery() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on RenameDocumentMutationPayload { updatedDocument { name } }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getVariables() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return {id: this.props.document.id, newName: this.props.newName};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getConfigs() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return [{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;FIELDS_CHANGE&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // Correlate the `updatedDocument` field in the response</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // with the DataID of the record we would like updated.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fieldIDs: {updatedDocument: this.props.document.id},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /* ... */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="node_delete"></a><code>NODE_DELETE</code><a class="hash-link" href="#node_delete" title="Direct link to heading">#</a></h3><p>Given a parent, a connection, and one or more DataIDs in the response payload, Relay will remove the node(s) from the connection and delete the associated record(s) from the store.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="arguments-1"></a>Arguments<a class="hash-link" href="#arguments-1" title="Direct link to heading">#</a></h4><ul><li><p><code>parentName: string</code></p><p>The field name in the response that represents the parent of the connection</p></li><li><p><code>parentID?: string</code></p><p>The DataID of the parent node that contains the connection. This argument is optional.</p></li><li><p><code>connectionName: string</code></p><p>The field name in the response that represents the connection</p></li><li><p><code>deletedIDFieldName: string</code></p><p>The field name in the response that contains the DataID of the deleted node</p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-1"></a>Example<a class="hash-link" href="#example-1" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class DestroyShipMutation extends Relay.Mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // This mutation declares a dependency on an enemy ship&#x27;s ID</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // and the ID of the faction that ship belongs to.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static fragments = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ship: () =&gt; Relay.QL`fragment on Ship { id, faction { id } }`,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Destroying a ship will remove it from a faction&#x27;s fleet, so we</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // specify the faction&#x27;s ships connection as part of the fat query.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getFatQuery() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on DestroyShipMutationPayload {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        destroyedShipID,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        faction { ships },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getConfigs() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return [{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;NODE_DELETE&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      parentName: &#x27;faction&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      parentID: this.props.ship.faction.id,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      connectionName: &#x27;ships&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      deletedIDFieldName: &#x27;destroyedShipID&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /* ... */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="range_add"></a><code>RANGE_ADD</code><a class="hash-link" href="#range_add" title="Direct link to heading">#</a></h3><p>Given a parent, a connection, and the name of the newly created edge in the response payload Relay will add the node to the store and attach it to the connection according to the range behavior specified.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="arguments-2"></a>Arguments<a class="hash-link" href="#arguments-2" title="Direct link to heading">#</a></h4><ul><li><p><code>parentName: string</code></p><p>The field name in the response that represents the parent of the connection</p></li><li><p><code>parentID?: string</code></p><p>The DataID of the parent node that contains the connection. This argument is optional.</p></li><li><p><code>connectionName: string</code></p><p>The field name in the response that represents the connection</p></li><li><p><code>edgeName: string</code></p><p>The field name in the response that represents the newly created edge</p></li><li><p><code>rangeBehaviors: {[call: string]: GraphQLMutatorConstants.RANGE_OPERATIONS} | (connectionArgs: {[argName: string]: string}) =&gt; $Keys&lt;GraphQLMutatorConstants.RANGE_OPERATIONS&gt;</code></p><p>A map between printed, dot-separated GraphQL calls <em>in alphabetical order</em> and the behavior we want Relay to exhibit when adding the new edge to connections under the influence of those calls or a function accepting an array of connection arguments, returning that behavior.</p></li></ul><p>For example, <code>rangeBehaviors</code> could be written this way:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">const rangeBehaviors = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // When the ships connection is not under the influence</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // of any call, append the ship to the end of the connection</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &#x27;&#x27;: &#x27;append&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Prepend the ship, wherever the connection is sorted by age</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &#x27;orderby(newest)&#x27;: &#x27;prepend&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Or this way, with the same results:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">const rangeBehaviors = ({orderby}) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if (orderby === &#x27;newest&#x27;) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return &#x27;prepend&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return &#x27;append&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Behaviors can be one of <code>&#x27;append&#x27;</code>, <code>&#x27;ignore&#x27;</code>, <code>&#x27;prepend&#x27;</code>, <code>&#x27;refetch&#x27;</code>, or <code>&#x27;remove&#x27;</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-2"></a>Example<a class="hash-link" href="#example-2" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class IntroduceShipMutation extends Relay.Mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // This mutation declares a dependency on the faction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // into which this ship is to be introduced.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static fragments = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    faction: () =&gt; Relay.QL`fragment on Faction { id }`,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Introducing a ship will add it to a faction&#x27;s fleet, so we</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // specify the faction&#x27;s ships connection as part of the fat query.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getFatQuery() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on IntroduceShipPayload {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        faction { ships },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        newShipEdge,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getConfigs() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return [{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;RANGE_ADD&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      parentName: &#x27;faction&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      parentID: this.props.faction.id,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      connectionName: &#x27;ships&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      edgeName: &#x27;newShipEdge&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      rangeBehaviors: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // When the ships connection is not under the influence</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // of any call, append the ship to the end of the connection</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;&#x27;: &#x27;append&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // Prepend the ship, wherever the connection is sorted by age</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;orderby(newest)&#x27;: &#x27;prepend&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /* ... */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="range_delete"></a><code>RANGE_DELETE</code><a class="hash-link" href="#range_delete" title="Direct link to heading">#</a></h3><p>Given a connection, one or more DataIDs in the response payload, and a path between the parent and the connection, Relay will remove the node(s) from the connection but leave the associated record(s) in the store.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="arguments-3"></a>Arguments<a class="hash-link" href="#arguments-3" title="Direct link to heading">#</a></h4><ul><li><p><code>deletedIDFieldName: string | Array&lt;string&gt;</code></p><p>The field name in the response that contains the DataID of the removed node, or the path to the node removed from the connection</p></li><li><p><code>pathToConnection: Array&lt;string&gt;</code></p><p>An array containing the field names between the parent and the connection, including the parent and the connection</p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-3"></a>Example<a class="hash-link" href="#example-3" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class RemoveTagMutation extends Relay.Mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // This mutation declares a dependency on the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // todo from which this tag is being removed.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static fragments = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    todo: () =&gt; Relay.QL`fragment on Todo { id }`,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Removing a tag from a todo will affect its tags connection</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // so we specify it here as part of the fat query.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getFatQuery() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on RemoveTagMutationPayload {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        todo { tags },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        removedTagIDs,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getConfigs() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return [{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;RANGE_DELETE&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      deletedIDFieldName: &#x27;removedTagIDs&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      pathToConnection: [&#x27;todo&#x27;, &#x27;tags&#x27;],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /* ... */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="required_children"></a><code>REQUIRED_CHILDREN</code><a class="hash-link" href="#required_children" title="Direct link to heading">#</a></h3><p>A <code>REQUIRED_CHILDREN</code> config is used to append additional children to the mutation query. You may need to use this, for example, to fetch fields on a new object created by the mutation (and which Relay would normally not attempt to fetch because it has not previously fetched anything for that object).</p><p>Data fetched as a result of a <code>REQUIRED_CHILDREN</code> config is not written into the client store, but you can add code that processes it in the <code>onSuccess</code> callback that you pass into <code>commitUpdate()</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">this.props.relay.commitUpdate(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  new CreateCouponMutation(),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    onSuccess: response =&gt; this.setState({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      couponCount: response.coupons.length,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="arguments-4"></a>Arguments<a class="hash-link" href="#arguments-4" title="Direct link to heading">#</a></h4><ul><li><code>children: Array&lt;RelayQuery.Node&gt;</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-4"></a>Example<a class="hash-link" href="#example-4" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class CreateCouponMutation extends Relay.Mutation&lt;Props&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getMutation() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      create_coupon(data: $input)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }`;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getFatQuery() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // Note the use of `pattern: true` here to show that this</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // connection field is to be used for pattern-matching only</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // (to determine what to fetch) and that Relay shouldn&#x27;t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // require the usual connection arguments like (`first` etc)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // to be present.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on CouponCreatePayload @relay(pattern: true) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        coupons</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getConfigs() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return [{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // If we haven&#x27;t shown the coupons in the UI at the time the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // mutation runs, they&#x27;ve never been fetched and the `coupons`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // field in the fat query would normally be ignored.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // `REQUIRED_CHILDREN` forces it to be retrieved anyway.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      type: RelayMutationType.REQUIRED_CHILDREN,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      children: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          fragment on CouponCreatePayload {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            coupons</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        `,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="optimistic-updates"></a>Optimistic updates<a class="hash-link" href="#optimistic-updates" title="Direct link to heading">#</a></h2><p>All of the mutations we&#x27;ve performed so far have waited on a response from the server before updating the client-side store. Relay offers us a chance to craft an optimistic response of the same shape based on what we expect the server&#x27;s response to be in the event of a successful mutation.</p><p>Let&#x27;s craft an optimistic response for the <code>LikeStoryMutation</code> example above:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class LikeStoryMutation extends Relay.Mutation {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /* ... */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Here&#x27;s the fat query from before</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getFatQuery() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on LikeStoryPayload {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        story {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          likers {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            count,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          likeSentence,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          viewerDoesLike,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // Let&#x27;s craft an optimistic response that mimics the shape of the</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // LikeStoryPayload, as well as the values we expect to receive.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  getOptimisticResponse() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      story: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        id: this.props.story.id,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        likers: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          count: this.props.story.likers.count + (this.props.story.viewerDoesLike ? -1 : 1),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        viewerDoesLike: !this.props.story.viewerDoesLike,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // To be able to increment the likers count, and flip the viewerDoesLike</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // bit, we need to ensure that those pieces of data will be available to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // this mutation, in addition to the ID of the story.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static fragments = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    story: () =&gt; Relay.QL`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment on Story {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        id,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        likers { count },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        viewerDoesLike,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    `,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  /* ... */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You don&#x27;t have to mimic the entire response payload. Here, we&#x27;ve punted on the like sentence, since it&#x27;s difficult to localize on the client side. When the server responds, Relay will treat its payload as the source of truth, but in the meantime, the optimistic response will be applied right away, allowing the people who use our product to enjoy instant feedback after having taken an action.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/relay/edit/master/website-v2/versioned_docs/version-classic/Classic-Guides-Mutations.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-03-10T02:44:04.000Z" class="docLastUpdatedAt_1Qna">3/10/2021</time> by <strong>Juan Tejada</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/classic/classic-guides-ready-state"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Ready State</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/classic/classic-guides-network-layer"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Network Layer Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#a-complete-example" class="table-of-contents__link">A complete example</a></li><li><a href="#mutation-props" class="table-of-contents__link">Mutation props</a></li><li><a href="#fragment-variables" class="table-of-contents__link">Fragment variables</a></li><li><a href="#the-fat-query" class="table-of-contents__link">The fat query</a></li><li><a href="#mutator-configuration" class="table-of-contents__link">Mutator configuration</a><ul><li><a href="#fields_change" class="table-of-contents__link"><code>FIELDS_CHANGE</code></a></li><li><a href="#node_delete" class="table-of-contents__link"><code>NODE_DELETE</code></a></li><li><a href="#range_add" class="table-of-contents__link"><code>RANGE_ADD</code></a></li><li><a href="#range_delete" class="table-of-contents__link"><code>RANGE_DELETE</code></a></li><li><a href="#required_children" class="table-of-contents__link"><code>REQUIRED_CHILDREN</code></a></li></ul></li><li><a href="#optimistic-updates" class="table-of-contents__link">Optimistic updates</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" rel="noopener noreferrer" href="/docs">Introduction</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" rel="noopener noreferrer" href="/users">User Showcase</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img class="footer__logo" src="/img/relay.svg"></div></div></div></footer></div>
<script src="/styles.eabf7aae.js"></script>
<script src="/runtime~main.d6510d2e.js"></script>
<script src="/main.4ed6baaf.js"></script>
<script src="/1.c175ab1b.js"></script>
<script src="/2.3344836f.js"></script>
<script src="/3.2a8c3dea.js"></script>
<script src="/1be78505.25680110.js"></script>
<script src="/1097.563a0540.js"></script>
<script src="/3acb18f9.c3ef18ff.js"></script>
<script src="/17896441.c41b5144.js"></script>
<script src="/08013621.215dc1fa.js"></script>
</body>
</html>